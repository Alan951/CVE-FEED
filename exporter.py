import csv

class Exporter():

    def export(self, data, file = None):
        if file == None:
            #TODO add default name of output
            pass

        f = open(file, 'w', newline="")

        with f:
            if 'headerInfo' in data[0]:
                fnames = data[0]['headerInfo']
            else:
                fnames = ['cve', 'found', 'cvss']

            del data[0]

            writer = csv.DictWriter(f, fieldnames=fnames)
            writer.writeheader()
            for item in data:
                writer.writerow(item)
            


if __name__ == '__main__':
    exporter = Exporter()
    exporter.export()